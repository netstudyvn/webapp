<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H·ªì s∆° NƒÉng l·ª±c Chuy√™n nghi·ªáp</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #1a5276;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --text-color: #333;
            --text-light: #7f8c8d;
            --card-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
            --hover-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);
            color: var(--text-color);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            background: linear-gradient(120deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: 16px;
            margin-bottom: 30px;
            box-shadow: var(--card-shadow);
            overflow: hidden;
        }
        
        .profile-header {
            display: flex;
            align-items: center;
            padding: 40px;
            position: relative;
        }
        
        .avatar-container {
            position: relative;
            margin-right: 30px;
        }
        
        .avatar {
            width: 140px;
            height: 140px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ffffff 0%, #e3f2fd 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 50px;
            color: var(--primary-color);
            border: 5px solid rgba(255, 255, 255, 0.4);
            box-shadow: 0 0 0 4px rgba(255, 255, 255, 0.2);
            overflow: hidden;
        }
        
        .avatar-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }
        
        .profile-badge {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: var(--accent-color);
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            border: 3px solid white;
        }
        
        .profile-info {
            flex: 1;
        }
        
        .profile-info h1 {
            font-size: 32px;
            margin-bottom: 8px;
            font-weight: 700;
        }
        
        .profile-title {
            font-size: 18px;
            opacity: 0.9;
            margin-bottom: 20px;
        }
        
        .contact-info {
            display: flex;
            flex-wrap: wrap;
            gap: 25px;
            margin-top: 20px;
        }
        
        .contact-item {
            display: flex;
            align-items: center;
            font-size: 16px;
            background: rgba(255, 255, 255, 0.15);
            padding: 10px 18px;
            border-radius: 50px;
            backdrop-filter: blur(5px);
        }
        
        .contact-item i {
            margin-right: 10px;
            font-size: 18px;
            width: 24px;
            text-align: center;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
        }
        
        .skills-section {
            background-color: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: var(--card-shadow);
            transition: transform 0.3s ease;
            height: fit-content;
        }
        
        .skills-section:hover {
            transform: translateY(-5px);
        }
        
        .section-title {
            font-size: 24px;
            color: var(--primary-color);
            margin-bottom: 25px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--light-color);
            display: flex;
            align-items: center;
        }
        
        .section-title i {
            margin-right: 12px;
            color: var(--secondary-color);
        }
        
        .skills-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .skill-item {
            padding: 20px;
            border-radius: 12px;
            background: #f8fafc;
            border-left: 4px solid var(--secondary-color);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .skill-item:hover {
            background: #e8f4fd;
            transform: translateX(5px);
        }
        
        .skill-item.active {
            background: linear-gradient(135deg, #e8f4fd, #d4e9fa);
            border-left: 4px solid var(--accent-color);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.2);
        }
        
        .skill-name {
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--dark-color);
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .skill-name i {
            margin-right: 10px;
            color: var(--secondary-color);
        }
        
        .skill-count {
            background: var(--secondary-color);
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 14px;
        }
        
        .skill-description {
            font-size: 15px;
            color: var(--text-light);
            line-height: 1.7;
        }
        
        .exercises-section {
            background-color: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: var(--card-shadow);
        }
        
        .exercises-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .transport-filter {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            padding: 10px 20px;
            background-color: var(--light-color);
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            color: var(--text-color);
            display: flex;
            align-items: center;
        }
        
        .filter-btn:hover {
            background-color: #d6dbdf;
        }
        
        .filter-btn.active {
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
            color: white;
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }
        
        .exercises-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }
        
        .exercise-card {
            border: 1px solid #eaeaea;
            border-radius: 12px;
            padding: 25px;
            transition: all 0.3s ease;
            cursor: pointer;
            background: white;
        }
        
        .exercise-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--hover-shadow);
            border-color: var(--secondary-color);
        }
        
        .exercise-title {
            font-size: 20px;
            color: var(--primary-color);
            margin-bottom: 12px;
        }
        
        .exercise-meta {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            color: var(--text-light);
            margin-bottom: 18px;
        }
        
        .exercise-description-container {
            margin-bottom: 20px;
        }
        
        .exercise-description {
            font-size: 15px;
            color: #555;
            line-height: 1.6;
            white-space: pre-line;
            word-wrap: break-word;
            background: #f8f9fa;
            padding: 12px 15px;
            border-radius: 8px;
            border-left: 4px solid var(--secondary-color);
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            margin: 0;
            display: block;
        }
        
        .exercise-description.collapsed {
            max-height: 120px;
            overflow: hidden;
        }
        
        .exercise-description.collapsed::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 40px;
            background: linear-gradient(transparent, #f8f9fa);
        }
        
        .show-more-btn {
            background: var(--secondary-color);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            margin-top: 10px;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }
        
        .show-more-btn:hover {
            background: var(--primary-color);
            transform: translateY(-2px);
        }
        
        .show-more-btn i {
            font-size: 12px;
            transition: transform 0.3s ease;
        }
        
        .show-more-btn.expanded i {
            transform: rotate(180deg);
        }
        
        .transport-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background-color: var(--secondary-color);
            color: white;
            margin-right: 8px;
        }
        
        .exercise-skills {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px dashed #e0e0e0;
        }
        
        .skill-tag {
            display: inline-block;
            background: #e1f0fa;
            color: var(--primary-color);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 14px;
            margin: 5px 8px 5px 0;
            border: 1px solid #bde0fe;
        }
        
        .skill-tag i {
            margin-right: 5px;
            font-size: 12px;
        }
        
        .exercise-date {
            display: flex;
            align-items: center;
            margin-top: 15px;
            font-size: 14px;
            color: var(--text-light);
        }
        
        .exercise-date i {
            margin-right: 5px;
        }
        
        .no-exercises {
            text-align: center;
            padding: 40px;
            color: var(--text-light);
            font-size: 18px;
        }
        
        .no-exercises i {
            font-size: 48px;
            margin-bottom: 20px;
            color: #bdc3c7;
        }
        
        .loading {
            text-align: center;
            padding: 3rem;
        }
        
        .error-message {
            background: #ffeaa7;
            border: 1px solid #fdcb6e;
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            margin: 2rem 0;
        }
        
        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .profile-header {
                flex-direction: column;
                text-align: center;
                padding: 30px 20px;
            }
            
            .avatar-container {
                margin-right: 0;
                margin-bottom: 20px;
            }
            
            .contact-info {
                justify-content: center;
            }
            
            .transport-filter {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Loading State -->
        <div id="loading" class="loading">
            <div class="spinner" style="font-size: 3rem; color: var(--secondary-color); margin-bottom: 1rem;">
                <i class="fas fa-spinner fa-spin"></i>
            </div>
            <h3>ƒêang t·∫£i d·ªØ li·ªáu...</h3>
            <p>Vui l√≤ng ch·ªù trong gi√¢y l√°t</p>
        </div>

        <!-- Error Message -->
        <div id="errorMessage" class="error-message" style="display: none;">
            <i class="fas fa-exclamation-triangle" style="font-size: 2rem; color: #e74c3c; margin-bottom: 1rem;"></i>
            <h3 id="errorTitle">ƒê√£ x·∫£y ra l·ªói</h3>
            <p id="errorText"></p>
            <button onclick="goBackToAppSheet()" style="margin-top: 15px; padding: 10px 20px; background: var(--primary-color); color: white; border: none; border-radius: 5px; cursor: pointer;">
                <i class="fas fa-arrow-left"></i> Quay l·∫°i AppSheet
            </button>
        </div>

        <!-- Profile Content -->
        <div id="profileContent" style="display: none;">
            <!-- Will be populated by JavaScript -->
        </div>
    </div>

    <script>
        // API URL - Apps Script Web App c·ªßa b·∫°n
        const API_URL = 'https://script.google.com/macros/s/AKfycbzeXvrU4KN2JIT36FMnIF8lo8c5Rd86UTcbndOrpiEnyitoJedC_V0sEMW5oTbZFfoEXA/exec';

        // L·∫•y username t·ª´ URL
        function getUsernameFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('username');
        }

        // Load profile data t·ª´ API
        async function loadProfile() {
            const username = getUsernameFromURL();
            
            if (!username) {
                showError('Thi·∫øu th√¥ng tin', 'Vui l√≤ng truy c·∫≠p t·ª´ AppSheet v·ªõi tham s·ªë username.');
                return;
            }

            try {
                showLoading('ƒêang t·∫£i th√¥ng tin c√° nh√¢n...');
                
                // G·ªçi API Apps Script
                const response = await fetch(`${API_URL}?username=${encodeURIComponent(username)}`);
                const result = await response.json();
                
                if (!result.success) {
                    showError('L·ªói d·ªØ li·ªáu', result.error);
                    return;
                }

                // Render data l√™n giao di·ªán
                renderProfile(result.data);
                
            } catch (error) {
                console.error('L·ªói:', error);
                showError('L·ªói k·∫øt n·ªëi', 'Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu t·ª´ h·ªá th·ªëng. Vui l√≤ng th·ª≠ l·∫°i.');
            }
        }

        // Render profile data
        function renderProfile(data) {
            const { profile, skills, exercises } = data;
            
            const profileHtml = `
                <header>
                    <div class="profile-header">
                        <div class="avatar-container">
                            <div class="avatar">
                                ${profile.avatarUrl ? 
                                    `<img class="avatar-img" src="${profile.avatarUrl}" alt="Avatar" onerror="handleImageError(this)">` : 
                                    `<i class="fas fa-user"></i>`
                                }
                            </div>
                            <div class="profile-badge">
                                <i class="fas fa-award"></i>
                            </div>
                        </div>
                        <div class="profile-info">
                            <h1>${profile.fullName || 'Ch∆∞a c·∫≠p nh·∫≠t'}</h1>
                            <div class="profile-title">${profile.role || 'Ch∆∞a c·∫≠p nh·∫≠t'}</div>
                            <div class="contact-info">
                                <div class="contact-item">
                                    <i class="fas fa-envelope"></i>
                                    <span>${profile.email || 'Ch∆∞a c·∫≠p nh·∫≠t'}</span>
                                </div>
                                <div class="contact-item">
                                    <i class="fas fa-phone"></i>
                                    <span>${profile.phone || 'Ch∆∞a c·∫≠p nh·∫≠t'}</span>
                                </div>
                                <div class="contact-item">
                                    <i class="fas fa-map-marker-alt"></i>
                                    <span>${profile.address || 'Ch∆∞a c·∫≠p nh·∫≠t'}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </header>
                
                <div class="main-content">
                    ${renderSkillsSection(skills)}
                    ${renderExercisesSection(exercises)}
                </div>
            `;
            
            document.getElementById('loading').style.display = 'none';
            document.getElementById('profileContent').style.display = 'block';
            document.getElementById('profileContent').innerHTML = profileHtml;
            
            initializeEventHandlers();
        }

        // Render skills section
        function renderSkillsSection(skills) {
            if (!skills || skills.length === 0) {
                return `<section class="skills-section">
                    <h2 class="section-title"><i class="fas fa-tools"></i>K·ªπ nƒÉng th·ª±c h√†nh</h2>
                    <p style="text-align: center; color: var(--text-light); padding: 2rem;">Ch∆∞a c√≥ k·ªπ nƒÉng n√†o ƒë∆∞·ª£c ƒë√°nh gi√°</p>
                </section>`;
            }
            
            const skillsHtml = skills.map((skill, index) => `
                <div class="skill-item ${index === 0 ? 'active' : ''}" data-id="${skill.id}" data-name="${skill.name}">
                    <div class="skill-name">
                        <div>
                            <i class="${skill.icon || 'fas fa-cogs'}"></i>
                            ${skill.name}
                        </div>
                        <span class="skill-count">${skill.exerciseCount || 0} b√†i</span>
                    </div>
                    <div class="skill-description">${skill.description || 'Kh√¥ng c√≥ m√¥ t·∫£'}</div>
                </div>
            `).join('');
            
            return `<section class="skills-section">
                <h2 class="section-title"><i class="fas fa-tools"></i>K·ªπ nƒÉng th·ª±c h√†nh</h2>
                <div class="skills-list">${skillsHtml}</div>
            </section>`;
        }

        // Render exercises section
        function renderExercisesSection(exercises) {
            if (!exercises || exercises.length === 0) {
                return `<section class="exercises-section">
                    <h2 class="section-title"><i class="fas fa-tasks"></i>B√†i t·∫≠p ƒë√£ ho√†n th√†nh</h2>
                    <div class="no-exercises">
                        <i class="fas fa-inbox"></i>
                        <p>Ch∆∞a c√≥ b√†i t·∫≠p n√†o ho√†n th√†nh.</p>
                        <p style="font-size: 14px; margin-top: 10px;">C√°c b√†i t·∫≠p ho√†n th√†nh s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã t·∫°i ƒë√¢y.</p>
                    </div>
                </section>`;
            }
            
            const exercisesHtml = exercises.map(exercise => `
                <div class="exercise-card" data-id="${exercise.id}">
                    <h3 class="exercise-title">${exercise.title || 'B√†i t·∫≠p kh√¥ng t√™n'}</h3>
                    <div class="exercise-meta">
                        <span>
                            <span class="transport-icon">${getTransportIcon(exercise.transport)}</span>
                            ${getTransportText(exercise.transport)}
                        </span>
                        <span>${exercise.date || "Ch∆∞a c·∫≠p nh·∫≠t ng√†y"}</span>
                    </div>
                    
                    <div class="exercise-description-container">
                        <div class="exercise-description collapsed" id="desc-${exercise.id}">
                            ${exercise.description ? exercise.description.trim() : "Kh√¥ng c√≥ m√¥ t·∫£"}
                        </div>
                        ${exercise.description && exercise.description.length > 150 ? `
                            <button class="show-more-btn" data-target="desc-${exercise.id}">
                                <span>Hi·ªÉn th·ªã th√™m</span>
                                <i class="fas fa-chevron-down"></i>
                            </button>
                        ` : ''}
                    </div>
                    
                    ${exercise.date ? `
                    <div class="exercise-date">
                        <i class="far fa-calendar-alt"></i> Ng√†y ho√†n th√†nh: ${exercise.date}
                    </div>
                    ` : ''}
                    
                    <div class="exercise-skills">
                        <div style="margin: 10px 0; font-weight: 600; color: var(--primary-color);">
                            <i class="fas fa-list-ul"></i> K·ªπ nƒÉng ƒë√£ th·ª±c h√†nh:
                        </div>
                        ${exercise.skills && exercise.skills.length > 0 ? 
                            exercise.skills.map(skill => `
                                <span class="skill-tag">
                                    <i class="fas fa-check-circle"></i>
                                    ${skill}
                                </span>
                            `).join('') : 
                            '<p style="color: var(--text-light); font-style: italic;">Kh√¥ng c√≥ k·ªπ nƒÉng n√†o ƒë∆∞·ª£c g√°n</p>'
                        }
                    </div>
                </div>
            `).join('');
            
            return `<section class="exercises-section">
                <div class="exercises-header">
                    <h2 class="section-title">
                        <i class="fas fa-tasks"></i>
                        B√†i t·∫≠p ƒë√£ ho√†n th√†nh
                        <span style="font-size: 16px; color: var(--text-light); margin-left: 10px;">(${exercises.length} b√†i)</span>
                    </h2>
                    
                    <div class="transport-filter">
                        <button class="filter-btn active" data-filter="all">
                            <i class="fas fa-layer-group"></i> T·∫•t c·∫£
                        </button>
                        <button class="filter-btn" data-filter="sea">
                            <span class="transport-icon">‚õ¥</span> ƒê∆∞·ªùng bi·ªÉn
                        </button>
                        <button class="filter-btn" data-filter="air">
                            <span class="transport-icon">‚úàÔ∏è</span> ƒê∆∞·ªùng h√†ng kh√¥ng
                        </button>
                        <button class="filter-btn" data-filter="road">
                            <span class="transport-icon">üöõ</span> ƒê∆∞·ªùng b·ªô
                        </button>
                    </div>
                </div>
                <div class="exercises-grid">${exercisesHtml}</div>
            </section>`;
        }

        // Helper functions
        function getTransportIcon(transport) {
            const icons = {
                'sea': '‚õ¥',
                'air': '‚úàÔ∏è',
                'road': 'üöõ'
            };
            return icons[transport] || 'üöö';
        }

        function getTransportText(transport) {
            const texts = {
                'sea': 'ƒê∆∞·ªùng bi·ªÉn',
                'air': 'ƒê∆∞·ªùng h√†ng kh√¥ng',
                'road': 'ƒê∆∞·ªùng b·ªô'
            };
            return texts[transport] || 'Kh√¥ng x√°c ƒë·ªãnh';
        }

        function showLoading(message = 'ƒêang t·∫£i d·ªØ li·ªáu...') {
            document.getElementById('loading').style.display = 'block';
            document.getElementById('errorMessage').style.display = 'none';
            document.getElementById('profileContent').style.display = 'none';
        }

        function showError(title, message) {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('errorMessage').style.display = 'block';
            document.getElementById('profileContent').style.display = 'none';
            document.getElementById('errorTitle').textContent = title;
            document.getElementById('errorText').textContent = message;
        }

        function goBackToAppSheet() {
            if (window.history.length > 1) {
                window.history.back();
            } else {
                window.close();
            }
        }

        function handleImageError(img) {
            img.style.display = 'none';
            const avatar = img.closest('.avatar');
            if (avatar) {
                const icon = document.createElement('i');
                icon.className = 'fas fa-user';
                icon.style.fontSize = '50px';
                icon.style.color = 'var(--primary-color)';
                avatar.appendChild(icon);
            }
        }

        // Kh·ªüi t·∫°o event handlers
        function initializeEventHandlers() {
            // B·ªô l·ªçc ph∆∞∆°ng ti·ªán v·∫≠n chuy·ªÉn
            const filterButtons = document.querySelectorAll('.filter-btn');
            filterButtons.forEach(button => {
                button.addEventListener('click', () => {
                    filterButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    filterExercises(button.getAttribute('data-filter'));
                });
            });
            
            // Click k·ªπ nƒÉng ƒë·ªÉ l·ªçc b√†i t·∫≠p
            const skillItems = document.querySelectorAll('.skill-item');
            skillItems.forEach(item => {
                item.addEventListener('click', () => {
                    // X√≥a active t·ª´ t·∫•t c·∫£ k·ªπ nƒÉng
                    skillItems.forEach(skill => skill.classList.remove('active'));
                    // Th√™m active cho k·ªπ nƒÉng ƒë∆∞·ª£c ch·ªçn
                    item.classList.add('active');
                    
                    // L·ªçc b√†i t·∫≠p theo k·ªπ nƒÉng
                    const skillName = item.getAttribute('data-name');
                    filterExercisesBySkill(skillName);
                });
            });
            
            // N√∫t hi·ªÉn th·ªã th√™m
            const showMoreButtons = document.querySelectorAll('.show-more-btn');
            showMoreButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const targetId = this.getAttribute('data-target');
                    const description = document.getElementById(targetId);
                    const icon = this.querySelector('i');
                    const textSpan = this.querySelector('span');
                    
                    if (description.classList.contains('collapsed')) {
                        description.classList.remove('collapsed');
                        textSpan.textContent = 'Thu g·ªçn';
                        this.classList.add('expanded');
                    } else {
                        description.classList.add('collapsed');
                        textSpan.textContent = 'Hi·ªÉn th·ªã th√™m';
                        this.classList.remove('expanded');
                    }
                });
            });
            
            // T·ª∞ ƒê·ªòNG L·ªåC THEO K·ª∏ NƒÇNG ƒê·∫¶U TI√äN KHI TRANG LOAD
            if (skillItems.length > 0) {
                const firstSkill = skillItems[0];
                const firstSkillName = firstSkill.getAttribute('data-name');
                filterExercisesBySkill(firstSkillName);
            }
        }

        // L·ªçc b√†i t·∫≠p theo ph∆∞∆°ng ti·ªán v·∫≠n chuy·ªÉn
        function filterExercises(filter) {
            const exercises = document.querySelectorAll('.exercise-card');
            const activeSkill = document.querySelector('.skill-item.active');
            const activeSkillName = activeSkill ? activeSkill.getAttribute('data-name') : null;
            
            exercises.forEach(exercise => {
                const transportElement = exercise.querySelector('.transport-icon');
                if (!transportElement) {
                    exercise.style.display = 'none';
                    return;
                }
                
                const transportIcon = transportElement.textContent.trim();
                let shouldShowByTransport = true;
                
                if (filter !== 'all') {
                    const transportMap = {
                        'sea': '‚õ¥',
                        'air': '‚úàÔ∏è',
                        'road': 'üöõ'
                    };
                    
                    const expectedIcon = transportMap[filter];
                    if (transportIcon !== expectedIcon) {
                        shouldShowByTransport = false;
                    }
                }
                
                // K·∫øt h·ª£p l·ªçc ph∆∞∆°ng ti·ªán v√† k·ªπ nƒÉng
                let shouldShowBySkill = true;
                if (activeSkillName) {
                    const skills = exercise.querySelectorAll('.skill-tag');
                    let hasSkill = false;
                    
                    skills.forEach(skill => {
                        if (skill.textContent.includes(activeSkillName)) {
                            hasSkill = true;
                        }
                    });
                    shouldShowBySkill = hasSkill;
                }
                
                exercise.style.display = (shouldShowByTransport && shouldShowBySkill) ? 'block' : 'none';
            });
            
            // C·∫≠p nh·∫≠t th√¥ng b√°o n·∫øu c·∫ßn
            updateNoExercisesMessage();
        }

        // L·ªçc b√†i t·∫≠p theo k·ªπ nƒÉng
        function filterExercisesBySkill(skillName) {
            const exercises = document.querySelectorAll('.exercise-card');
            const activeTransport = document.querySelector('.filter-btn.active');
            const activeFilter = activeTransport ? activeTransport.getAttribute('data-filter') : 'all';
            
            exercises.forEach(exercise => {
                const transportElement = exercise.querySelector('.transport-icon');
                const skills = exercise.querySelectorAll('.skill-tag');
                
                let hasSkill = false;
                skills.forEach(skill => {
                    if (skill.textContent.includes(skillName)) {
                        hasSkill = true;
                    }
                });
                
                let shouldShowByTransport = true;
                if (activeFilter !== 'all' && transportElement) {
                    const transportIcon = transportElement.textContent.trim();
                    const transportMap = {
                        'sea': '‚õ¥',
                        'air': '‚úàÔ∏è',
                        'road': 'üöõ'
                    };
                    const expectedIcon = transportMap[activeFilter];
                    shouldShowByTransport = transportIcon === expectedIcon;
                }
                
                exercise.style.display = (hasSkill && shouldShowByTransport) ? 'block' : 'none';
            });
            
            updateNoExercisesMessage();
        }

        // C·∫≠p nh·∫≠t th√¥ng b√°o khi kh√¥ng c√≥ b√†i t·∫≠p
        function updateNoExercisesMessage() {
            const exercises = document.querySelectorAll('.exercise-card');
            const visibleExercises = Array.from(exercises).filter(ex => ex.style.display !== 'none');
            const exercisesContainer = document.querySelector('.exercises-grid');
            let noExercisesMessage = exercisesContainer.querySelector('.no-exercises-message');
            
            if (visibleExercises.length === 0) {
                if (!noExercisesMessage) {
                    noExercisesMessage = document.createElement('div');
                    noExercisesMessage.className = 'no-exercises-message';
                    noExercisesMessage.innerHTML = `
                        <div class="no-exercises">
                            <i class="fas fa-search"></i>
                            <p>Kh√¥ng t√¨m th·∫•y b√†i t·∫≠p ph√π h·ª£p</p>
                            <p style="font-size: 14px; margin-top: 10px;">H√£y th·ª≠ ch·ªçn b·ªô l·ªçc kh√°c</p>
                        </div>
                    `;
                    exercisesContainer.appendChild(noExercisesMessage);
                }
            } else {
                if (noExercisesMessage) {
                    noExercisesMessage.remove();
                }
            }
        }

        // Kh·ªüi ch·∫°y ·ª©ng d·ª•ng
        document.addEventListener('DOMContentLoaded', loadProfile);
    </script>
</body>
</html>
